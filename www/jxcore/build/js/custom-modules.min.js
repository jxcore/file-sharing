!function(e){function n(e){var n=document.createElement("script");n.async=!1,n.src=e+"socket.io/socket.io.js",document.body.appendChild(n),function a(){window.io?(t.value("enums",enums),t.value("host",e),angular.bootstrap(document,[t.name])):setTimeout(a,5)}()}var t=angular.module(e.name,["ui.router","ngResource","ngSanitize","ngAnimate","btford.socket-io"].concat(e.dependencies)).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(n,t,a){n.state(e.name,{url:"",template:"<div ui-view></div>","abstract":!0,resolve:{socketSrvc:["$q","$rootScope","socketFactory","host","notify",function(e,n,t,a,r){"/"===a&&(a=":"+(location.port||80)+"/");try{var o=t({prefix:"server:",ioSocket:io.connect(a)}),i=0,c=o.emit;return o.emit=function(t,a){1===++i&&n.$broadcast("loading:progress"),console.log("emitted",t);var u=e.defer();return c.call(o,t,a,function(e,a){0===--i&&n.$broadcast("loading:finish"),e?(r.error(t+": "+e),u.reject(e)):(console.log("answered",t),u.resolve(a))}),u.promise},o.forward(["game-created","player-joined-game","game-started","filled","player-left-game","game-discarded"]),o}catch(u){alert(u.message)}}]}}),a.html5Mode(!1).hashPrefix("!")}]).run(["$rootScope","enums",function(e,n){e.enums=n}]);!function a(){"undefined"==typeof jxcore?setTimeout(a,5):"none"===jxcore||"none"===cordova?n("/"):jxcore.isReady(function(){jxcore("alert").register(alert),jxcore("app.js").loadMainFile(function(e,t){t?alert(t):jxcore("getLocalIP").call(function(e){n(e)})})})}(),function(n){angular.module(e.name).directive(n.name,[function(){return{restrict:"E",template:'<div class="cd-burger" ng-class="expanded ? \'expanded\' : null" ng-transclude></div>',transclude:!0,replace:!0,scope:!0,controller:["$scope","$attrs",function(e,n){var t=this;t.expanded=function(n){return"undefined"==typeof n?e.expanded:void(e.expanded=n)},t.toggle=function(){t.expanded(!e.expanded)},e.$on("$stateChangeSuccess",function(){t.expanded(!1)})}]}}]).directive(n.name+"Menu",[function(){return{restrict:"E",template:'<div class="cd-burger-menu" ng-transclude></div>',transclude:!0,replace:!0}}]).directive(n.name+"Content",[function(){return{restrict:"E",template:'<div class="cd-burger-content" ng-transclude></div>',transclude:!0,replace:!0}}]).directive(n.name+"Header",[function(){return{restrict:"E",templateUrl:n.path+"/header.html",transclude:!0,replace:!0,require:"^"+n.name,scope:!0,link:function(e,n,t,a){e.expanded=a.expanded,e.toggle=a.toggle}}}]).directive(n.name+"Body",[function(){return{restrict:"E",template:'<div class="cd-burger-body" ng-transclude></div>',transclude:!0,replace:!0}}])}({name:"cdBurger",path:"./modules/a/directives/cdBurger"}),function(n){angular.module(e.name).directive(n.name,["dateFilter",function(e){return{restrict:"A",require:"ngModel",link:function(n,t,a,r){r.$formatters.unshift(function(n){return e(n,"yyyy-MM-dd")}),r.$parsers.unshift(function(e){return new Date(e)})}}}])}({name:"cdDateInput",path:"./modules/a/directives/cdDateInput"}),function(n){angular.module(e.name).directive(n.name,[function(){return{restrict:"A",require:"ngModel",link:function(e,t,a,r){function o(){var t=r.$viewValue,o=e.$eval(a[n.name]);r.$setValidity("equals",t===o)}e.$watch(a.ngModel,o),e.$watch(a[n.name],o)}}}])}({name:"cdEquals",path:"./modules/a/directives/cdEquals"}),function(n){angular.module(e.name).directive(n.name,["fileUpload",function(e){return{restrict:"A",require:"ngModel",link:function(t,a,r,o){a.on("click",function(){var a=angular.element('<input type="file"/>'),i=t.$eval(r[n.name]);a.on("change",function(n){var t=n.target.files;e.upload(t,i).then(function(e){o.$setViewValue(e)},function(e){alert(e.response)})}),a.get(0).click()})}}}])}({name:"cdFileUpload",path:"./modules/a/directives/cdFileUpload"}),function(n){angular.module(e.name).directive(n.name,[function(){return{restrict:"C",link:function(e,n,t,a){e.$on("loading:progress",function(){n.show()}),e.$on("loading:finish",function(){n.hide()})}}}])}({name:"cdLoadingIndicator",path:"./modules/a/directives/cdLoadingIndicator"}),function(n){angular.module(e.name).directive(n.name,[function(){return{restrict:"A",link:function(e,t,a){t.keypress(function(t){13==t.which&&e.$apply(a[n.name])})}}}])}({name:"cdOnPressEnter",path:"./modules/a/directives/cdOnPressEnter"}),function(n){angular.module(e.name).directive(n.name,["$compile","$controller","$http","$templateCache","$q","$state","$resolve",function(e,t,a,r,o,i,c){return{restrict:"A",link:function(u,l,d){function s(n,a){tmplScope=u.$new(),tmplCtrl=t(a.controller,angular.extend({$scope:tmplScope},n.locals)),l.html(n.template),l.children().data("$ngControllerController",tmplCtrl),e(l.contents())(tmplScope)}u.$watch(d[n.name],function(e){var n;resolveFns=e.resolve||{};for(var t=i.$current;t;)angular.extend(resolveFns,t.resolve),t=t.parent;n=e.templateUrl?a.get(e.templateUrl,{cache:r}).then(function(e){return e.data}):o.when(e.template),c.resolve(resolveFns).then(function(e){return n.then(function(n){return{locals:e,template:n}})}).then(function(n){s(n,e)})})}}}])}({name:"cdPartial",path:"./modules/a/directives/cdPartial"}),function(n){angular.module(e.name).directive(n.name,[function(){return{restrict:"A",require:"ngModel",priority:101,link:function(e,t,a,r){var o=a[n.name];r.$formatters.push(function(e){return e&&"string"==typeof e&&0===e.indexOf(o)?e.substring(o.length,e.length):void 0}),r.$parsers.push(function(e){return e?o+e:e})}}}])}({name:"cdPrefix",path:"./modules/a/directives/cdPrefix"}),function(n){angular.module(e.name).directive(n.name,[function(){return{restrict:"A",link:function(e,t,a){var r;t.click(function(e){r&&e.preventDefault()}),e.$watch(a[n.name],function(e){r=e,r?t.addClass("inactive"):t.removeClass("inactive")})}}}])}({name:"cdPreventDefault",path:"./modules/a/directives/cdPreventDefault"}),function(n){angular.module(e.name).directive(n.name,["$state",function(e){return{restrict:"A",link:function(e,t,a){t.click(function(e){e.preventDefault(),window.location.href=a[n.name]||t.attr("href")})}}}])}({name:"cdRawHref",path:"./modules/a/directives/cdRawHref"}),function(n){angular.module(e.name).directive(n.name,["$timeout","scrollSrvc",function(e,t){return{restrict:"A",link:function(e,a,r){e.$watch(r[n.name],function(e){e&&t.scrollDown(a,0)})}}}])}({name:"cdScrollDownDefault",path:"./modules/a/directives/cdScrollDownDefault"}),function(n){angular.module(e.name).directive(n.name,["scrollSrvc",function(e){return{restrict:"A",link:function(t,a,r){t.$eval(r[n.name]).forEach(function(n){t.$on(n,function(){e.scrollDown(a)})})}}}])}({name:"cdScrollDownOn",path:"./modules/a/directives/cdScrollDownOn"}),function(n){angular.module(e.name).directive(n.name,[function(){return{restrict:"A",link:function(e,n,t){n.click(function(e){e.stopPropagation()})}}}])}({name:"cdStopPropagation",path:"./modules/a/directives/cdStopPropagation"}),function(n){angular.module(e.name).directive(n.name,[function(){return{restrict:"E",replace:!0,template:'<canvas width="400" height="400" id="canvas"></canvas>',scope:{dimWidth:"=",dimHeight:"=",winningScore:"=",turnIndex:"=",meIndex:"=",letters:"=",onInit:"="},link:function(e,n,t){var a=new xox.Game({context:n.get(0).getContext("2d"),width:e.dimWidth,height:e.dimHeight,winningScore:e.winningScore,turnIndex:e.turnIndex,meIndex:e.meIndex,letters:e.letters}),r=a.scene.context.canvas,o=r.parentNode.getBoundingClientRect(),i=o.width>400?400:o.width;r.width=i,r.height=i,a.scene.redraw(),e.onInit(a)}}}])}({name:"cdXox",path:"./modules/a/directives/cdXox"}),function(n){angular.module(e.name).directive(n.name,["$state",function(e){function t(e){var n=e.parent().inheritedData("$uiView");return n&&n.state&&n.state.name?n.state:void 0}return{restrict:"A",link:function(a,r,o){var i=o[n.name+"Class"]||"active";a.$on("$stateChangeSuccess",function(){var a=t(r)||e.$current,c=e.includes(o[n.name],null,{relative:a});c?o.$addClass(i):o.$removeClass(i)})}}}])}({name:"uiSrefContains",path:"./modules/a/directives/uiSrefContains"}),function(n){angular.module(e.name).directive(n.name,["$state",function(e){return{restrict:"A",link:function(t,a,r){t.$on("$stateChangeSuccess",function(){var a=angular.extend({},e.params,t.$eval(r[n.name])),o=e.href(e.current,a);r.$set("href",o)})}}}])}({name:"uiSrefParams",path:"./modules/a/directives/uiSrefParams"}),function(n){angular.module(e.name).provider(n.name,[function(){var e=this;e.defaultOptions={name:"file",action:"/upload",typeValidator:"image.*"},e.$get=["$q",function(n){return{upload:function(t,a){for(var r,a=angular.extend({},e.defaultOptions,a),o=new FormData,i=n.defer(),c=0;c<t.length;c++){if(r=t[c],!r.type.match(a.typeValidator))return i.reject("Wrong file type: "+r.type);o.append(a.name,r,r.name)}var u=new XMLHttpRequest;return u.onload=function(){200===u.status?i.resolve(u.response):i.reject(u)},u.open("POST",a.action,!0),u.send(o),i.promise}}}]}])}({name:"fileUpload",path:"./modules/a/factories/fileUpload"}),function(n){angular.module(e.name).factory(n.name,["$q","$injector","$location","$rootScope","notify",function(e,n,t,a,r){var o=0;return{request:function(e){return 1===++o&&a.$broadcast("loading:progress"),e||$q.when(e)},response:function(e){return 0===--o&&a.$broadcast("loading:finish"),e||$q.when(e)},responseError:function(t){n.get("$state");switch(t.status){case 404:r.info(t.data||"რესურსი არ მოიძებნა");break;case 500:r.info(t.data||"სერვერის შეცდომა")}return 0===--o&&a.$broadcast("loading:finish"),e.reject(t)}}}]).config(["$httpProvider",function(e){e.interceptors.push(n.name)}])}({name:"httpInterceptor",path:"./modules/a/factories/httpInterceptor"}),function(n){angular.module(e.name).factory(n.name,[function(){return{info:function(e){alert("info: "+e)},error:function(e){alert("error: "+e)}}}])}({name:"notify",path:"./modules/a/factories/notify"}),function(n){angular.module(e.name).factory(n.name,["$state","$urlMatcherFactory","$location",function(e,n,t){function a(e){try{return decodeURIComponent(e)}catch(n){}}function r(e){var n,t,r={};return angular.forEach((e||"").split("&"),function(e){if(e&&(n=e.replace(/\+/g,"%20").split("="),t=a(n[0]),angular.isDefined(t))){var o=angular.isDefined(n[1])?a(n[1]):!0;hasOwnProperty.call(r,t)?angular.isArray(r[t])?r[t].push(o):r[t]=[r[t],o]:r[t]=o}}),r}function o(e){var n=e.split("?");return{path:n[0],search:n[1]?r(n[1]):{}}}return{resolveFromUrl:function(t){for(var a,r=e.get(),i=0;a=r[i];i++)if(!a["abstract"]){for(var c,u=a.name.split("."),l=n.compile(""),d=0;c=u[d];d++){var s=e.get(u.slice(0,d+1).join("."));s.url&&(l=l.concat(s.url))}var m=o(t),f=l.exec(m.path,m.search);if(f)return{params:f,state:a}}},getStateContext:function(e){var n=e.parent().inheritedData("$uiView");return n&&n.state&&n.state.name?n.state:void 0}}}])}({name:"stateHelper",path:"./modules/a/factories/stateHelper"}),function(n){angular.module(e.name).filter(n.name,[function(){return function(e,n){return e.map(function(e){return e[n]})}}])}({name:"map",path:"./modules/a/filters/map"}),function(n){angular.module(e.name).filter(n.name,[function(){return function(e){return e.reduce(function(e,n){return e.concat(n)},[])}}])}({name:"reduce",path:"./modules/a/filters/reduce"})}({name:"a",path:"./modules/a",dependencies:["a.main"]}),function(e){angular.module(e.name,e.dependencies).config(["$stateProvider",function(n){n.state(e.name,{url:"",templateUrl:e.path+"/views/layout.html",controller:e.name+".c.main","abstract":!0,resolve:{localIP:["host",function(e){return"/"===e?window.location.path:e}]}})}]),function(n){angular.module(e.name).controller(e.name+".c."+n.name,["$scope","$state","localIP",function(e,n,t){e.localIP=t}])}({name:"main",path:"./modules/a.main/controllers/main"})}({name:"a.main",path:"./modules/a.main",dependencies:["a.main.create","a.main.find","a.main.room"]}),function(e){angular.module(e.name,e.dependencies).config(["$stateProvider",function(n){n.state(e.name,{url:"/create",templateUrl:e.path+"/views/layout.html",controller:e.name+".c.create"})}]),function(n){angular.module(e.name).controller(e.name+".c."+n.name,["$scope","$state","socketSrvc",function(e,n,t){e.game={width:3,height:3,maxPlayers:2,winningScore:3,turnIndex:0},e.create=function(){t.emit("create-game",e.game).then(function(e){n.go("^.room",{gameId:e.id})})}}])}({name:"create",path:"./modules/a.main.create/controllers/create"})}({name:"a.main.create",path:"./modules/a.main.create",dependencies:[]}),function(e){angular.module(e.name,e.dependencies).config(["$stateProvider",function(n){n.state(e.name,{url:"",templateUrl:e.path+"/views/layout.html",controller:e.name+".c.find",resolve:{games:["socketSrvc",function(e){return e.emit("get-games")}]}})}]),function(n){angular.module(e.name).controller(e.name+".c."+n.name,["$scope","$state","socketSrvc","games",function(e,n,t,a){e.games=a,e.enterGame=function(e){n.go("^.room",{gameId:e.id})},e.$on("server:game-started",function(n,t){utils.findOne(e.games,{id:t.gameId},function(e){e&&(e.started=!0)})}),e.$on("server:game-created",function(n,t){e.games.push(t)}),e.$on("server:game-discarded",function(n,t){utils.findOne(e.games,{id:t.gameId},function(n,t){e.games.splice(t,1)})})}])}({name:"find",path:"./modules/a.main.find/controllers/find"})}({name:"a.main.find",path:"./modules/a.main.find",dependencies:[]}),function(e){angular.module(e.name,e.dependencies).config(["$stateProvider",function(n){n.state(e.name,{url:"/room/:gameId",templateUrl:e.path+"/views/layout.html",controller:e.name+".c.room",resolve:{game:["$stateParams","$state","socketSrvc",function(e,n,t){return t.emit("enter-game",{gameId:e.gameId})["catch"](function(){n.go("a.main.find")})}]}})}]),function(n){angular.module(e.name).controller(e.name+".c."+n.name,["$scope","$state","game","socketSrvc",function(e,n,t,a){e.game=t,e.meIndex,e.over,e.letters,e.$watchCollection("game.players",function(n){e.letters=["X","O","Z","Y","K","P","R","S","T","Q"].slice(0,n.length)}),e.start=function(){a.emit("start-game",{gameId:e.game.id})},e.init=function(n){n.on("filled",function(n){a.emit("fill",{i:n.i,j:n.j,gameId:e.game.id})}),n.on("over",function(t){alert(n.winner?"Winner is "+n.winner:"Draw"),e.over=!0}),e.$on("server:filled",function(t,a){a.gameId===e.game.id&&n.fill(a.i,a.j,!1,!0)})},e.$on("$destroy",function(){a.emit("leave-game").then(function(){alert("You left the game")})}),e.$on("server:game-discarded",function(t,a){a.gameId===e.game.id&&(alert("Game has been discarded"),n.go("^.find"))}),e.$on("server:player-left-game",function(n,t){if(t.gameId===e.game.id){var a=e.game.players;a.splice(a.indexOf(t.playerSocketId),1)}}),e.$on("server:player-joined-game",function(n,t){t.gameId===e.game.id&&e.game.players.push(t.playerSocketId)}),e.$on("server:game-started",function(n,t){t.gameId===e.game.id&&(e.meIndex=t.meIndex,e.game.started=!0)})}])}({name:"room",path:"./modules/a.main.room/controllers/room"})}({name:"a.main.room",path:"./modules/a.main.room",dependencies:[]});