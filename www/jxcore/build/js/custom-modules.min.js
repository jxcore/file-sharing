!function(e){function n(e,n){var a=document.createElement("script");a.async=!1,a.src=e+"/socket.io/socket.io.js",document.body.appendChild(a),function o(){window.io?(t.value("enums",enums),t.value("host",e),t.value("isMobile",n),angular.bootstrap(document,[t.name])):setTimeout(o,5)}()}var t=angular.module(e.name,["ui.router","ngResource","ngSanitize","ngAnimate"].concat(e.dependencies)).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(n,t,a){n.state(e.name,{url:"",template:"<div ui-view></div>","abstract":!0}),a.html5Mode(!1).hashPrefix("!")}]).run(["$rootScope","enums",function(e,n){e.enums=n}]);!function a(){"undefined"==typeof jxcore?setTimeout(a,5):"none"===jxcore||"none"===cordova?n(window.location.origin,!1):jxcore.isReady(function(){jxcore("alert").register(alert),jxcore("app.js").loadMainFile(function(e,t){t?alert(t):jxcore("getHost").call(function(e){n(e,!0)})})})}(),function(n){angular.module(e.name).directive(n.name,["$state","host","isMobile","loadingSrvc",function(e,t,a,o){return{restrict:"A",link:function(e,r,i){r.click(function(e){var r=i[n.name],c=encodeURI(t+"/download/"+r);a?(o.push(),window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(e){e.root.getFile(r,{create:!0,exclusive:!1},function(e){var n=e.toURL();"Android"===device.platform&&0===n.indexOf("file://")&&(n=n.substring(7));var t=new FileTransfer;t.download(c,n,function(e){o.pull(),alert("File saved to: "+e.toURI())},function(e){o.pull(),alert("download error source: "+e.source),alert("download error target: "+e.target),alert("upload error code: "+e.code)})},function(){o.pull(),alert("Error getFile")},!0)},function(){o.pull(),alert("Error requestFileSystem")})):window.location.href=c})}}}])}({name:"cdFileDownload",path:"./modules/app/directives/cdFileDownload"}),function(n){angular.module(e.name).directive(n.name,[function(){return{restrict:"C",link:function(e,n,t,a){e.$on("loading:progress",function(){n.show()}),e.$on("loading:finish",function(){n.hide()})}}}])}({name:"cdLoadingIndicator",path:"./modules/app/directives/cdLoadingIndicator"}),function(n){angular.module(e.name).directive(n.name,[function(){return{restrict:"A",link:function(e,t,a){t.keypress(function(t){13==t.which&&e.$apply(a[n.name])})}}}])}({name:"cdOnPressEnter",path:"./modules/app/directives/cdOnPressEnter"}),function(n){angular.module(e.name).directive(n.name,["$compile","$controller","$http","$templateCache","$q","$state","$resolve",function(e,t,a,o,r,i,c){return{restrict:"A",link:function(l,u,s){function d(n,a){tmplScope=l.$new(),tmplCtrl=t(a.controller,angular.extend({$scope:tmplScope},n.locals)),u.html(n.template),u.children().data("$ngControllerController",tmplCtrl),e(u.contents())(tmplScope)}l.$watch(s[n.name],function(e){var n;resolveFns=e.resolve||{};for(var t=i.$current;t;)angular.extend(resolveFns,t.resolve),t=t.parent;n=e.templateUrl?a.get(e.templateUrl,{cache:o}).then(function(e){return e.data}):r.when(e.template),c.resolve(resolveFns).then(function(e){return n.then(function(n){return{locals:e,template:n}})}).then(function(n){d(n,e)})})}}}])}({name:"cdPartial",path:"./modules/app/directives/cdPartial"}),function(n){angular.module(e.name).directive(n.name,[function(){return{restrict:"A",link:function(e,t,a){var o;t.click(function(e){o&&e.preventDefault()}),e.$watch(a[n.name],function(e){o=e,o?t.addClass("inactive"):t.removeClass("inactive")})}}}])}({name:"cdPreventDefault",path:"./modules/app/directives/cdPreventDefault"}),function(n){angular.module(e.name).directive(n.name,[function(){return{restrict:"A",require:"ngModel",link:function(e,n,t,a){function o(n){var t=n.target.files,o=n.target.multiple;e.$apply(function(){a.$setViewValue(o?t:t.length?t[0]:null)}),r()}function r(){n.empty(),angular.element('<input type="file"/>').on("change",o).appendTo(n)}r()}}}])}({name:"cdSelectFile",path:"./modules/app/directives/cdSelectFile"}),function(n){angular.module(e.name).directive(n.name,[function(){return{restrict:"A",link:function(e,n,t){n.click(function(e){e.stopPropagation()})}}}])}({name:"cdStopPropagation",path:"./modules/app/directives/cdStopPropagation"}),function(n){angular.module(e.name).directive(n.name,["$state",function(e){function t(e){var n=e.parent().inheritedData("$uiView");return n&&n.state&&n.state.name?n.state:void 0}return{restrict:"A",link:function(a,o,r){var i=r[n.name+"Class"]||"active";a.$on("$stateChangeSuccess",function(){var a=t(o)||e.$current,c=e.includes(r[n.name],null,{relative:a});c?r.$addClass(i):r.$removeClass(i)})}}}])}({name:"uiSrefContains",path:"./modules/app/directives/uiSrefContains"}),function(n){angular.module(e.name).directive(n.name,["$state",function(e){return{restrict:"A",link:function(t,a,o){t.$on("$stateChangeSuccess",function(){var a=angular.extend({},e.params,t.$eval(o[n.name])),r=e.href(e.current,a);o.$set("href",r)})}}}])}({name:"uiSrefParams",path:"./modules/app/directives/uiSrefParams"}),function(n){angular.module(e.name).provider(n.name,[function(){var e=this;e.$get=["$q","socketSrvc",function(e,n){return{upload:function(e){return n.emit("addFile",{metadata:{name:e.name,size:e.size,type:e.type},content:e})},remove:function(e){return n.emit("removeFile",{name:e})}}}]}])}({name:"fileUpload",path:"./modules/app/factories/fileUpload"}),function(n){angular.module(e.name).factory(n.name,["$q","$injector","$location","loadingSrvc","notify",function(e,n,t,a,o){return{request:function(e){return a.push(),e||$q.when(e)},response:function(e){return a.pull(),e||$q.when(e)},responseError:function(t){n.get("$state");switch(t.status){case 404:o.info(t.data||"რესურსი არ მოიძებნა");break;case 500:o.info(t.data||"სერვერის შეცდომა")}return a.pull(),e.reject(t)}}}]).config(["$httpProvider",function(e){e.interceptors.push(n.name)}])}({name:"httpInterceptor",path:"./modules/app/factories/httpInterceptor"}),function(n){angular.module(e.name).factory(n.name,["$rootScope",function(e){var n=0;return{loading:n,push:function(){1===++n&&e.$broadcast("loading:progress")},pull:function(){0===--n&&e.$broadcast("loading:finish")}}}])}({name:"loadingSrvc",path:"./modules/app/factories/loadingSrvc"}),function(n){angular.module(e.name).factory(n.name,[function(){return{info:function(e){alert("info: "+e)},error:function(e){alert("error: "+e)}}}])}({name:"notify",path:"./modules/app/factories/notify"}),function(n){angular.module(e.name).provider(n.name,[function(){this.socket,this.broadcasts=["file-added","file-removed"],this.$get=["$q","$rootScope","$location","notify","host","loadingSrvc",function(e,n,t,a,o,r){var i=this.socket||io.connect(o,{forceNew:!0});return this.broadcasts.forEach(function(e){i.on(e,function(t){n.$apply(function(){n.$broadcast(e,t)})})}),{emit:function(n,t){var a=e.defer();return r.push(),i.emit(n,t,function(e,n){r.pull(),e?(console.error("ws error:",e),a.reject(e)):a.resolve(n)}),a.promise},on:function(e,t){i.on(e,function(){t.apply(this,arguments),n.$apply()})}}}]}])}({name:"socketSrvc",path:"./modules/app/factories/socketSrvc"}),function(n){angular.module(e.name).factory(n.name,["$state","$urlMatcherFactory","$location",function(e,n,t){function a(e){try{return decodeURIComponent(e)}catch(n){}}function o(e){var n,t,o={};return angular.forEach((e||"").split("&"),function(e){if(e&&(n=e.replace(/\+/g,"%20").split("="),t=a(n[0]),angular.isDefined(t))){var r=angular.isDefined(n[1])?a(n[1]):!0;hasOwnProperty.call(o,t)?angular.isArray(o[t])?o[t].push(r):o[t]=[o[t],r]:o[t]=r}}),o}function r(e){var n=e.split("?");return{path:n[0],search:n[1]?o(n[1]):{}}}return{resolveFromUrl:function(t){for(var a,o=e.get(),i=0;a=o[i];i++)if(!a["abstract"]){for(var c,l=a.name.split("."),u=n.compile(""),s=0;c=l[s];s++){var d=e.get(l.slice(0,s+1).join("."));d.url&&(u=u.concat(d.url))}var f=r(t),p=u.exec(f.path,f.search);if(p)return{params:p,state:a}}},getStateContext:function(e){var n=e.parent().inheritedData("$uiView");return n&&n.state&&n.state.name?n.state:void 0}}}])}({name:"stateHelper",path:"./modules/app/factories/stateHelper"})}({name:"app",path:"./modules/app",dependencies:["app.files"]}),function(e){angular.module(e.name,e.dependencies).config(["$stateProvider",function(n){n.state(e.name,{url:"",templateUrl:e.path+"/views/layout.html",controller:e.name+".c.files",resolve:{fileMetadatas:["socketSrvc",function(e){return e.emit("getFileMetadatas")}]}})}]),function(n){angular.module(e.name).controller(e.name+".c."+n.name,["$scope","$state","host","fileMetadatas","fileUpload",function(e,n,t,a,o){e.host=t,e.fileMetadatas=a,e.file,e.$watch("file",function(n){n&&o.upload(n).then(function(){e.file=null})}),e.addFile=function(){o.upload()},e.$on("file-added",function(n,t){e.fileMetadatas.push(t)}),e.removeFile=function(e){confirm("Sure?")&&o.remove(e)},e.$on("file-removed",function(n,t){for(var a=0;a<e.fileMetadatas.length;a++)if(e.fileMetadatas[a].name===t.name){e.fileMetadatas.splice(a,1);break}})}])}({name:"files",path:"./modules/app.files/controllers/files"})}({name:"app.files",path:"./modules/app.files",dependencies:[]});